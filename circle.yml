machine:
  timezone:
    Asia/Tokyo
  ruby:
    version: 2.1.5
  services:
    - docker

test:
  override:
    - rake
    - mkdir -p ${CIRCLE_ARTIFACTS}/binary ${CIRCLE_ARTIFACTS}/log
    - cp -a files/binary/*.tar.gz ${CIRCLE_ARTIFACTS}/binary
    - cp -a files/log/*.log ${CIRCLE_ARTIFACTS}/log

deployment:
  production:
    branch: release
    commands:
      - go get github.com/tcnksm/ghr
      - ghr -u minimum2scp -r ruby-binary --draft v0.0.2 ${CIRCLE_ARTIFACTS}/binary/
